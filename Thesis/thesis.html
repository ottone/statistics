<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3" defer></script>
  <script src="./js/rsa.js" defer></script>
  <script src="./js/factor.js" defer></script>
  <script src="./js/decrypt.js" defer></script>
  <title>Decoding RSA with Statistics</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../style.css?v=2">
  <style>
    .bars-container { display:flex; align-items:flex-end; gap:6px; min-height:200px; }
    .bar { text-align:center; width:14px; }
    .bar-rect { border-radius:4px; width:100%; }
    .bar-label { margin-top:6px; font-size:12px; }
    .rsa-crack { background:#0b0b0b; color:#eee; padding:10px; border-radius:8px; margin-bottom:18px; }
    .rsa-crack .form-select, .rsa-crack .form-select-sm { background:#111 !important; color:#eee !important; border:1px solid #333 !important; }
    .rsa-crack .btn-crack { background:#dcdcdc; color:#222; border:none; }
  </style>
</head>
<body class="container py-4">
<header class="mb-5 text-center">
  <h1>Decoding RSA with Statistics</h1>
  <p class="lead">üß† Decoding RSA with Statistics</p>
</header>

<main>
<article>

<section aria-labelledby="user-interaction">
  <h2 id="user-interaction">üß© Algorithm</h2>

  <div class="explanation-transparent">
    <p>
      This section describes the statistical algorithm used to explore potential structural weaknesses of RSA
      by analysing modular sequences and their differences. The aim is not to break real RSA systems, but to
      illustrate how numerical patterns may reveal hidden information in simplified scenarios.
    </p>

    <h2>Step 1 ‚Äì Generation of Modular Sequences</h2>
    <p>
      We generate multiple sequences using the recursive rule:
    </p>
    <p style="text-align:center; font-weight:bold;">
      x<sub>n+1</sub> = (x<sub>n</sub><sup>2</sup> + c<sub>i</sub>) mod N
    </p>
    <p>
      Each sequence starts from a random initial value x<sub>0</sub> and uses a distinct constant c<sub>i</sub> to ensure variability.
      The modulo N operation links each sequence directly to the structure of the RSA modulus.
    </p>

    <h2>Step 2 ‚Äì Iterative Evolution</h2>
    <p>
      Each sequence is iterated for a fixed number of steps. The values remain bounded in the interval [0, N-1]
      and exhibit pseudo-random behaviour while still being influenced by the factorisation of N.
    </p>

    <h2>Step 3 ‚Äì Differences Between Sequences</h2>
    <p>
      At each iteration n, the difference between two sequences is computed as:
    </p>
    <p style="text-align:center; font-weight:bold;">
      D<sub>n</sub> = |x<sub>n</sub> - y<sub>n</sub>|
    </p>

    <h2>Step 4 ‚Äì Greatest Common Divisor</h2>
    <p>
      The greatest common divisor between the difference and the modulus is then calculated:
    </p>
    <p style="text-align:center; font-weight:bold;">
      g<sub>n</sub> = gcd(D<sub>n</sub>, N)
    </p>
    <p>
      If g<sub>n</sub> &gt; 1 occurs repeatedly, it is interpreted as a statistical indication of a potential non-trivial divisor of N.
    </p>

    <h2>Step 5 ‚Äì Identification of Candidate Divisors</h2>
    <p>
      Values of g that appear frequently are tested for divisibility of N. If N mod g = 0 and 1 &lt; g &lt; N,
      then g is a valid factor of the modulus and the second factor is obtained as N / g.
    </p>

    <h2>Step 6 ‚Äì Theoretical Reconstruction of the Private Key</h2>
    <p>
      Once the two factors p and q are known, Euler‚Äôs totient function is computed:
    </p>
    <p style="text-align:center; font-weight:bold;">
      œÜ(N) = (p - 1)(q - 1)
    </p>
    <p>
      The private key d is then derived as the modular inverse of e modulo œÜ(N), completing the theoretical compromise
      of the RSA key in this simplified framework.
    </p>

    <p>
      This algorithm highlights the conceptual relationship between modular arithmetic, statistical patterns and
      cryptographic security, demonstrating how even indirect numerical signals may reveal structural properties
      of cryptographic keys when improper parameters are used.
    </p>
  </div>
  
  <section class="mb-4">
  <h5>Select RSA Parameters</h5>

  <div class="row g-3 align-items-end">

    <div class="col-md-4">
      <label class="fw-bold">Modulus N</label>
      <select id="selectN" class="form-select rsa-select">
        <option value="221">221 (13 √ó 17)</option>
        <option value="299">299 (13 √ó 23)</option>
        <option value="437">437 (19 √ó 23)</option>
        <option value="2021">2021 (43 √ó 47)</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="fw-bold">Public exponent e</label>
      <select id="selectEParam" class="form-select rsa-select">
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="11" selected>11</option>
        <option value="17">17</option>
      </select>
    </div>

    <div class="col-md-4">
      <button id="applyRSAParams" class="btn btn-warning w-100">
        Apply parameters
      </button>
    </div>

  </div>
</section>


  <div class="rsa-crack mt-4">
  <h3>üîê RSA Parameters Used</h3>
  <p class="small text-muted">Valori realmente utilizzati dal file rsa.js (sola visualizzazione)</p>

 <div class="row g-3">

  <div class="col-md-3">
    <div class="fw-bold">Public exponent e</div>
    <div class="p-2 bg-dark rounded" id="displayE">-</div>
  </div>

  <div class="col-md-3">
    <div class="fw-bold">Modulus N</div>
    <div class="p-2 bg-dark rounded" id="displayN">-</div>
  </div>

  <div class="col-md-3">
    <div class="fw-bold">Factor p</div>
    <div class="p-2 bg-dark rounded" id="displayP">-</div>
  </div>

  <div class="col-md-3">
    <div class="fw-bold">Factor q</div>
    <div class="p-2 bg-dark rounded" id="displayQ">-</div>
  </div>

</div>

<div class="mt-3">
    <div class="fw-bold mb-1">Encrypted Tokens</div>
      <div class="p-3 bg-dark rounded" style="font-family: monospace; font-size: 0.9rem; max-height: 140px; overflow-y: auto;">
        <span id="displayTokens">-</span>
    </div>
  </div>

<section class="mt-5">
  <h2>üßÆ Statistical Factorization of N</h2>
  <p class="small text-muted">
    Educational model inspired by Pollard-type methods. This tool does not break real RSA,
    but shows how modular sequences and gcd patterns can reveal hidden structure in simplified settings.
  </p>

  <div class="row g-3 align-items-end">
    <div class="col-md-3">
      <label for="inputN" class="form-label">Modulus N</label>
      <input type="number" id="inputN" class="form-select rsa-select">
    </div>

    <div class="col-md-3">
      <label for="inputK" class="form-label">Iterations (k)</label>
      <input type="number" id="inputK" class="form-select rsa-select">
    </div>
    
    <div class="col-md-3">
      <label for="inputS" class="form-label">Sequences (S)</label>
      <input type="number" id="inputS" class="form-select rsa-select" value="8">
    </div>

    <div class="col-md-3 d-flex align-items-end">
      <button id="startFactor" class="btn btn-warning w-100">
        üîç Start Statistical Factorization
      </button>
    </div>
  </div>
 
   


  <div id="factorResult" class="mt-4" style="display:none;">
    <h5>Factorization result</h5>
    <pre id="factorOutput" class="explanation-transparent"></pre>
  </div>

  <div class="mt-4" style="height:350px; max-height:350px; overflow:hidden;">
    <h5>gcd histogram gcd(|x ‚àí y|,N)</h5>
    <canvas id="gcdChart"></canvas>
  </div>
<br>
<br>
<div class="mt-4" style="height:350px; max-height:350px; overflow:hidden;">
  <h5>Difference histogram (|x ‚àí y|)</h5>
  <canvas id="diffChart"></canvas>
</div>


  <!--<div class="table-responsive mt-4" id="iterTableBox" style="display:none;">-->
  <div class="table-responsive mt-4 d-none" id="iterTableBox">
  <h5>Iteration details</h5>
  <table class="table table-dark table-bordered table-sm text-center">
    <thead>
      <tr>
        <th>Iter</th>
        <th>x</th>
        <th>y</th>
        <th>|x - y|</th>
        <th>gcd(|x - y|, N)</th>
      </tr>
    </thead>
    <tbody id="iterTableBody"></tbody>
  </table>
</div>

</section>

<section class="mt-5">
  <h2>üîì Decrypt</h2>
  <p class="small text-muted">
    Insert the factors of N and the public exponent e to compute the private key
    and decrypt the ciphertext.
  </p>

  <div class="row g-3 align-items-end">
    <div class="col-md-3">
      <label class="fw-bold">Factor p</label>
      <input type="number" id="decP" class="form-control">
    </div>

    <div class="col-md-3">
      <label class="fw-bold">Factor q</label>
      <input type="number" id="decQ" class="form-control">
    </div>

    <div class="col-md-3">
      <label class="fw-bold">Public exponent e</label>
      <input type="number" id="decE" class="form-control">
    </div>

    <div class="col-md-3">
      <button id="decryptBtn" class="btn btn-success w-100">
        üîì Decrypt
      </button>
    </div>
  </div>

  <div class="mt-4">
    <div class="fw-bold mb-1">Decrypted Text</div>
    <div class="p-3 bg-dark rounded" style="font-family:monospace; white-space:pre-wrap;">
      <span id="decryptedOutput">-</span>
    </div>
  </div>
</section>


<div class="mt-4 text-center">
  <a href="../index.html" class="btn btn-primary">‚Üê Back to Home</a>
</div>

</article>
</main>

<footer class="mt-5 text-center">
  <hr>
  <p><small>&copy; 2025 Francesco - Statistics Thesis</small></p>
</footer>
</body>
</html>
