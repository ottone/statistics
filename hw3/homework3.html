<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3" defer></script>
  <script src="./js/rsa.js" defer></script>
  <title>Homework 3 - Decoding RSA with Distribution</title>
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../style.css?v=2">
  <style>
    /* stile per grafici e box RSA Crack */
    .bars-container { display:flex; align-items:flex-end; gap:6px; min-height:200px; }
    .bar { text-align:center; width:14px; }
    .bar-rect { border-radius:4px; width:100%; }
    .bar-label { margin-top:6px; font-size:12px; }
    .rsa-crack { background:#0b0b0b; color:#eee; padding:10px; border-radius:8px; margin-bottom:18px; }
    .rsa-crack .form-select, .rsa-crack .form-select-sm { background:#111 !important; color:#eee !important; border:1px solid #333 !important; }
    .rsa-crack .btn-crack { background:#dcdcdc; color:#222; border:none; }
  </style>
</head>

<body class="container py-4">
<header class="mb-5 text-center">
  <h1>Homework 3 - Decoding RSA with Distribution</h1>
  <p class="lead">üß† Decoding RSA Encryption Through Frequency Analysis</p>
</header>

<main>
<article>

<section aria-labelledby="user-interaction">
  <h2 id="user-interaction">üß© User Interaction</h2>
  <p>
  The demo starts from three realistic-sounding assumptions an analyst might have in a simple, educational scenario:
</p>
<ul>
  <li><strong>Small known set of possible public exponents (e)</strong> ‚Äî the attacker does not know the real public key but suspects it belongs to a short list of common values (for example 3, 5, 7, 11, 13, 17).</li>
  <li><strong>Ciphertext tokens are observable</strong> ‚Äî the attacker can see the sequence of encrypted tokens produced by the system (each token is a number: C).</li>
  <li><strong>Frequency information is available</strong> ‚Äî by counting how often each token appears, the attacker can hypothesize that the most frequent ciphertext tokens correspond to the most frequent plaintext letters (e.g. <em>E</em>, <em>T</em>, etc.).</li>
</ul>

<p>
  From those assumptions the attack proceeds with a simple insight: if we guess that a particular ciphertext token C corresponds to a plaintext letter L (mapped to a numeric value M, e.g. A=1 ‚Ä¶ Z=26) and we try a candidate public exponent e, then the value
  |M^e ‚àí C| must be divisible by the modulus N used in the RSA encryption (because C ‚â° M^e (mod N)).
  In other words, <strong>N is a divisor of M^e ‚àí C</strong>.
</p>

<p><strong>Step-by-step algorithm used in this demo</strong></p>
<ol>
  <li><strong>Choose a candidate e</strong> from the dropdown (one of the suspected public exponents).</li>
  <li><strong>Pick a ciphertext token C</strong> that, by frequency analysis, you suspect corresponds to a common plaintext letter. Help yourself in text frequency analysis, putting a text in "Plaintext Statistical Analysis" box</li>
  <li><strong>Select the suspected plaintext letter L</strong> (mapped to a number M between 1 and 26).</li>
  <li><strong>Compute D = |M^e ‚àí C|</strong> and factor D (or compute its divisors). Any nontrivial divisor of D is a candidate for N, because if the guess is correct then M^e ‚àí C is divisible by the true N.</li>
  <li><strong>Try candidate N values</strong>: for each plausible divisor, attempt to factor it into two primes p and q. If N = p¬∑q, compute Euler‚Äôs totient œÜ(N) = (p‚àí1)(q‚àí1).</li>
  <li><strong>Compute the private exponent d</strong> as the modular inverse of e modulo œÜ(N), i.e. find d such that e¬∑d ‚â° 1 (mod œÜ(N)). If such d exists, (N,d) is a valid private key pair for that candidate.</li>
  <li><strong>Use (N,d) to decrypt the whole ciphertext</strong> (letter-by-letter): M = C^d mod N, map numbers back to letters, and inspect the result in the <em>Decoding‚Ä¶</em> box.</li>
</ol>

<p><strong>Important notes & limitations</strong>:</p>
<ul>
  <li>This method only works in this simplified, didactic setting: real-world RSA uses very large moduli and different padding schemes that prevent this attack.</li>
  <li>A single (token, letter) guess may not identify N uniquely: often several divisors divide M^e ‚àí C. Using multiple guessed pairs or additional constraints (frequency matches across many tokens) increases confidence.</li>
  <li>If the chosen e is wrong or the guessed mapping is incorrect, the script will either fail to find valid p,q or it will produce incorrect plaintext; the UI is meant to let you experiment and learn how the math behaves.</li>
</ul>
</section>

<!-- üîπ RSA Crack box (nero) -->
<section class="rsa-crack" aria-labelledby="rsa-crack-title">
  <h3 id="rsa-crack-title" class="h6 mb-2">RSA Crack</h3>
  <div class="row g-2 align-items-end">
    <div class="col-sm-3">
      <label class="form-label text-muted small">Select e</label>
      <select id="selectE" class="form-select form-select-sm">
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="7">7</option>
        <option value="11" selected>11</option>
        <option value="13">13</option>
        <option value="17">17</option>
      </select>
    </div>

    <div class="col-sm-3">
      <label class="form-label text-muted small">Select token</label>
      <select id="selectToken" class="form-select form-select-sm">
        <option value="">-</option>
      </select>
    </div>

    <div class="col-sm-3">
      <label class="form-label text-muted small">Select letter</label>
      <select id="selectLetter" class="form-select form-select-sm">
        <option value="">-</option>
      </select>
    </div>

    <div class="col-sm-3 d-grid">
      <button id="crackBtn" class="btn btn-crack btn-sm fw-bold">Crack!</button>
    </div>
  </div>
</section>

<!-- üîπ Testo in chiaro -->
<section class="mt-2">
  <h2>Plaintext Statistical Analysis</h2>
  <textarea id="plainAnalysis" class="form-control" rows="4" placeholder="Scrivi qui del testo in inglese..."></textarea>

  <!-- üîπ Grafici affiancati -->
  <div id="barChartsWrapper" class="d-flex flex-column align-items-center mt-4" style="gap: 40px;">
    <div class="bar-chart w-100">
      <h6 class="text-center text-success">Frequency clear text</h6>
      <div id="barChartLetters" class="bars-container"></div>
    </div>

    <div class="bar-chart w-100">
      <h6 class="text-center text-primary">Frequency token</h6>
      <div id="barChartTokens" class="bars-container"></div>
    </div>
  </div>
</section>

<!-- üîπ Decodifica -->
<section class="mt-4" id="decodedSection" style="display:none;">
  <h2>üß© Decoding...</h2>
  <div id="decodedText" class="p-3 border rounded"></div>
</section>

<!-- Pulsante back -->
<div class="mt-4 text-center">
  <a href="../index.html" class="btn btn-primary">‚Üê Back to Home</a>
</div>

</article>
</main>

<footer class="mt-5 text-center">
  <hr>
  <p><small>&copy; 2025 Francesco ‚Äì Homework 3</small></p>
</footer>
</body>
</html>
